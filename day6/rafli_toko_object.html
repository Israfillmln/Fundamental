<script>


  const buku = [
    {
      bookName: "SCRUM",
      bookPrices: 50000,
      quantity: 0,
    },
    {
      bookName: "Math",
      bookPrices: 25000,
      quantity: 0,
    },
    {
      bookName: "Economy",
      bookPrices: 70000,
      quantity: 0,
    },
  ];

  let report = [];

  let objek = function (bookName, bookPrices, quantity) {
    buku.bookName = bookName;
    buku.bookPrices = bookPrices;
    buku.quantity = quantity;
  };

  const showReport = () => {
    let reportList = "";
    if (report.length === 0) {
      alert("Belum ada Transaksi");
    } else {
      for (let i = 0; i, report.length; i++) {
        reportList += `${i + 1}. ${report[i].bookName} Harga ${
          report[i].bookPrices
        } x ${report[i].quantity} - > Rp. ${(
          report[i].bookPrices * report[i].quantity
        ).toLocaleString()}\n`;
      }
      alert(reportList);
    }
  };

  const showMenu = (isPrompt = false) => {
    let bookList = "";
    for (let i = 0; i < buku.length; i++) {
      bookList += `${i + 1}. ${buku[i].bookName} || Rp. ${buku[
        i
      ].bookPrices.toLocaleString()} \n`;
    }
    if (isPrompt) {
      let userInput = prompt(bookList);
      userInput = parseInt(userInput);
      let userInputIndex = userInput - 1;
      return userInputIndex;
    }
    alert(bookList);
  };

  const adminAddData = () => {
    let userInputNewBook = prompt("Anda ingin menambahkan buku apa ?");
    let userInputNewPrice = prompt(
      "Berapa harga buku yang ingin anda tambahkan ?"
    );
    userInputNewBook = parseInt(userInputNewPrice);

    let newBook = new objek(userInputNewBook, userInputNewPrice, 0);
    buku.push(newBook);

    alert("Data berhasil di tambah");
  };

  const adminDeleteData = () => {
    const userDeleteItemIndex = showMenu(true);

    buku.splice(userDeleteItemIndex, 1);
  };

  const adminEditData = () => {
    const userEditItemIndex = showMenu(true);
    let userEditValue = prompt(
      `Anda ingin mengubah ${buku[userEditItemIndex].bookName} menjadi buku apa? `
    );
    let userEditPriceValue = prompt("Berapa harganya?");
    userEditPriceValue = parseInt(userEditPriceValue);
    buku[userEditItemIndex] = new objek(userEditValue, userEditPriceValue, 0);
  };

  //   user function

  const userAddToCart = () => {
    const userCartIndex = showMenu(true);

    let userCartQty = prompt(
      `Anda ingin beli ${buku[userCartIndex].bookName}`
    );
    userCartQty = parseInt(userCartQty);

    fruits[userCartIndex].quantity += userCartQty;
    fruits[userCartIndex].bought += userCartQty;
  };

  const userShowCart = (isCheckout = false) => {
    let userCart = "";
    let totalPrice = 0;

    for (let i = 0; i < buku.length; i++) {
      userCart += `${i + 1}. ${buku[i].fruitName} x ${
        buku[i].quantity
      } -> Rp. ${(
        buku[i].bookPrices * buku[i].quantity
      ).toLocaleString()} \n`;

      totalPrice += buku[i].bookPrices * buku[i].quantity;
    }

    if (isCheckout) {
      // Tambah baris untuk total price
      userCart += `\n Total belanjaan anda adalah Rp. ${totalPrice.toLocaleString()}`;

      let userPayment = prompt(userCart);
      userPayment = parseInt(userPayment);
      // Kalau lebih (kembalian)
      if (userPayment > totalPrice) {
        alert(
          `Kembalian anda sebesar Rp. ${(
            userPayment - totalPrice
          ).toLocaleString()}`
        );
      } else if (userPayment === totalPrice) {
        alert("Terima kasih");
      } else if (userPayment < totalPrice) {
        alert(
          `Uang anda kurang Rp. ${(totalPrice - userPayment).toLocaleString()}`
        );
      }

      for (let i = 0; i < fruits.length; i++) {
        if (fruits[i].quantity > 0) {
          report.push(
            new reportObject(
              buku[i].title,
              buku[i].price,
              buku[i].quantity
            )
          );
        }
      }
      for (let i = 0; i < buku.length; i++) {
        fruits[i].quantity = 0;
      }
      return;
    }
    alert(userCart);
  };

  do {
    // Main menu
    const userMainMenuInput = prompt(`Login sebagai:
                1. Admin
                2. User
                3. Exit`);

    if (userMainMenuInput == "1") {
      do {
        const adminMenuInput = prompt(`Menu:
                1. Tambah data
                2. Delete data
                3. Show data
                4. Edit data
                5. Show report
                6. Exit`);
        // Jika user pilih tambah data
        if (adminMenuInput == "1") {
          adminAddData();
        } else if (adminMenuInput == "2") {
          adminDeleteData();
        } else if (adminMenuInput == "3") {
          showMenu(false);
        } else if (adminMenuInput == "4") {
          // Jika user pilih update data
          adminEditData();
        } else if (adminMenuInput == "5") {
          showReport();
        } else if (adminMenuInput == "6") {
          break;
        }
      } while (true);
    } else if (userMainMenuInput == "2") {
      // Menu user
      do {
        const userMenuInput = prompt(`
                    1. Add to cart
                    2. Show cart
                    3. Checkout
                    4. Back`);
        if (userMenuInput == "1") {
          userAddToCart();
        } else if (userMenuInput == "2") {
          userShowCart();
        } else if (userMenuInput == "3") {
          userShowCart(true);
        } else if (userMenuInput == "4") {
          break;
        }
      } while (true);
    } else if (userMainMenuInput == "3") {
      break;
    }
  } while (true);
</script>

  
  
  
  
  

  
  
  
  